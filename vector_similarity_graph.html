<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‘é‡ç›¸ä¼¼åº¦è®¡ç®—å¯è§†åŒ–</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            border-bottom: 3px solid #3498db;
            padding-bottom: 15px;
        }
        h2 {
            color: #34495e;
            margin-top: 40px;
            border-left: 5px solid #3498db;
            padding-left: 15px;
        }
        .section {
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        .graph-container {
            margin: 20px 0;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            background: white;
        }
        .explanation {
            background: #e8f4f8;
            padding: 15px;
            border-left: 4px solid #3498db;
            margin: 15px 0;
            border-radius: 4px;
        }
        .formula {
            background: #fff3cd;
            padding: 15px;
            border-left: 4px solid #ffc107;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            border-radius: 4px;
        }
        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
        }
        .highlight {
            color: #e74c3c;
            font-weight: bold;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: center;
        }
        th {
            background-color: #3498db;
            color: white;
        }
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        .step-number {
            display: inline-block;
            background: #3498db;
            color: white;
            width: 30px;
            height: 30px;
            line-height: 30px;
            border-radius: 50%;
            text-align: center;
            margin-right: 10px;
        }
        .info-box {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¯ å‘é‡ç›¸ä¼¼åº¦è®¡ç®—å®Œæ•´å¯è§†åŒ–</h1>

        <div class="info-box">
            <strong>ğŸ“Œ å­¦ä¹ ç›®æ ‡ï¼š</strong> é€šè¿‡å¯è§†åŒ–å›¾è¡¨ç†è§£å¦‚ä½•ä½¿ç”¨ GTE æ¨¡å‹ç”Ÿæˆæ–‡æœ¬å‘é‡ï¼Œå¹¶è®¡ç®—å‘é‡ä¹‹é—´çš„ä½™å¼¦ç›¸ä¼¼åº¦ã€‚
        </div>

        <!-- Section 1: 2Då‘é‡ç©ºé—´å¯è§†åŒ– -->
        <h2><span class="step-number">1</span>2D å‘é‡ç©ºé—´å¯è§†åŒ–ï¼ˆç®€åŒ–ç¤ºä¾‹ï¼‰</h2>
        <div class="section">
            <div class="explanation">
                <strong>è¯´æ˜ï¼š</strong>å®é™…çš„ GTE æ¨¡å‹ç”Ÿæˆçš„æ˜¯ 768 ç»´å‘é‡ï¼Œä¸ºäº†ä¾¿äºç†è§£ï¼Œè¿™é‡Œå…ˆç”¨ 2D å‘é‡å±•ç¤ºä½™å¼¦ç›¸ä¼¼åº¦çš„å‡ ä½•æ„ä¹‰ã€‚
            </div>
            <div class="graph-container" id="plot2d"></div>
            <div class="explanation">
                <strong>è§‚å¯Ÿè¦ç‚¹ï¼š</strong>
                <ul>
                    <li>å‘é‡ä¹‹é—´çš„<span class="highlight">å¤¹è§’ Î¸</span> å†³å®šäº†ç›¸ä¼¼åº¦</li>
                    <li>å¤¹è§’è¶Šå°ï¼Œcos(Î¸) è¶Šå¤§ï¼Œç›¸ä¼¼åº¦è¶Šé«˜</li>
                    <li>"å¦‚ä½•å­¦ä¹ Javaç¼–ç¨‹" å’Œ "Javaå…¥é—¨æ•™ç¨‹" å¤¹è§’å°ï¼ˆçº¦15Â°ï¼‰ï¼Œç›¸ä¼¼åº¦é«˜ï¼ˆ0.97ï¼‰</li>
                    <li>"ä»Šå¤©å¤©æ°”çœŸå¥½" ä¸å‰ä¸¤è€…å¤¹è§’å¤§ï¼ˆçº¦85Â°ï¼‰ï¼Œç›¸ä¼¼åº¦ä½ï¼ˆ0.09ï¼‰</li>
                </ul>
            </div>
        </div>

        <!-- Section 2: ä½™å¼¦ç›¸ä¼¼åº¦å…¬å¼ -->
        <h2><span class="step-number">2</span>ä½™å¼¦ç›¸ä¼¼åº¦è®¡ç®—å…¬å¼</h2>
        <div class="section">
            <div class="formula">
                <strong>å…¬å¼ï¼š</strong><br>
                cosine_similarity(A, B) = (A Â· B) / (||A|| Ã— ||B||)<br><br>
                å…¶ä¸­ï¼š<br>
                â€¢ A Â· B = ç‚¹ç§¯ = Aâ‚€Ã—Bâ‚€ + Aâ‚Ã—Bâ‚ + Aâ‚‚Ã—Bâ‚‚ + ... + Aâ‚‡â‚†â‚‡Ã—Bâ‚‡â‚†â‚‡<br>
                â€¢ ||A|| = å‘é‡Açš„æ¨¡é•¿ = âˆš(Aâ‚€Â² + Aâ‚Â² + Aâ‚‚Â² + ... + Aâ‚‡â‚†â‚‡Â²)<br>
                â€¢ ||B|| = å‘é‡Bçš„æ¨¡é•¿ = âˆš(Bâ‚€Â² + Bâ‚Â² + Bâ‚‚Â² + ... + Bâ‚‡â‚†â‚‡Â²)
            </div>
        </div>

        <!-- Section 3: 3Då‘é‡ç©ºé—´å¯è§†åŒ– -->
        <h2><span class="step-number">3</span>3D å‘é‡ç©ºé—´å¯è§†åŒ–</h2>
        <div class="section">
            <div class="explanation">
                <strong>è¯´æ˜ï¼š</strong>è¿™é‡Œå±•ç¤º 3 ç»´å‘é‡ç©ºé—´ï¼Œå®é™… GTE æ¨¡å‹æ˜¯ 768 ç»´ã€‚åŸç†ç›¸åŒï¼Œåªæ˜¯ç»´åº¦æ›´é«˜ã€‚
            </div>
            <div class="graph-container" id="plot3d"></div>
            <div class="explanation">
                <strong>3D ç©ºé—´ä¸­çš„è§‚å¯Ÿï¼š</strong>
                <ul>
                    <li>ç»¿è‰²å’Œè“è‰²å‘é‡ï¼ˆJavaç›¸å…³ï¼‰æ–¹å‘æ¥è¿‘ï¼Œå¤¹è§’å°</li>
                    <li>çº¢è‰²å‘é‡ï¼ˆå¤©æ°”ï¼‰æ–¹å‘åç¦»è¾ƒå¤§</li>
                    <li>ä»åŸç‚¹å‡ºå‘çš„ç®­å¤´ä»£è¡¨å‘é‡æ–¹å‘</li>
                </ul>
            </div>
        </div>

        <!-- Section 4: é«˜ç»´å‘é‡é™ç»´å¯è§†åŒ– -->
        <h2><span class="step-number">4</span>768ç»´å‘é‡é™ç»´åˆ°2Dï¼ˆæ¨¡æ‹ŸçœŸå®åœºæ™¯ï¼‰</h2>
        <div class="section">
            <div class="explanation">
                <strong>è¯´æ˜ï¼š</strong>ä½¿ç”¨ PCAï¼ˆä¸»æˆåˆ†åˆ†æï¼‰æˆ– t-SNE å°† 768 ç»´å‘é‡é™åˆ° 2 ç»´è¿›è¡Œå¯è§†åŒ–ã€‚è¿™é‡Œæ¨¡æ‹ŸçœŸå®çš„ GTE å‘é‡åˆ†å¸ƒã€‚
            </div>
            <div class="graph-container" id="plotHighDim"></div>
            <div class="explanation">
                <strong>é™ç»´åçš„è§‚å¯Ÿï¼š</strong>
                <ul>
                    <li>ç›¸ä¼¼çš„å¥å­åœ¨é™ç»´ç©ºé—´ä¸­è·ç¦»æ›´è¿‘</li>
                    <li>ä¸åŒä¸»é¢˜çš„å¥å­è·ç¦»è¾ƒè¿œ</li>
                    <li>é™ç»´ä¿ç•™äº†ä¸»è¦çš„è¯­ä¹‰ä¿¡æ¯</li>
                </ul>
            </div>
        </div>

        <!-- Section 5: ç›¸ä¼¼åº¦çŸ©é˜µçƒ­åŠ›å›¾ -->
        <h2><span class="step-number">5</span>ç›¸ä¼¼åº¦çŸ©é˜µçƒ­åŠ›å›¾</h2>
        <div class="section">
            <div class="explanation">
                <strong>è¯´æ˜ï¼š</strong>è®¡ç®—æ‰€æœ‰å¥å­ä¸¤ä¸¤ä¹‹é—´çš„ä½™å¼¦ç›¸ä¼¼åº¦ï¼Œç”¨çƒ­åŠ›å›¾å±•ç¤ºã€‚
            </div>
            <div class="graph-container" id="heatmap"></div>
            <div class="explanation">
                <strong>çƒ­åŠ›å›¾è§£è¯»ï¼š</strong>
                <ul>
                    <li>é¢œè‰²è¶Š<span style="color: #d73027; font-weight: bold;">çº¢</span>ï¼Œç›¸ä¼¼åº¦è¶Šé«˜</li>
                    <li>é¢œè‰²è¶Š<span style="color: #4575b4; font-weight: bold;">è“</span>ï¼Œç›¸ä¼¼åº¦è¶Šä½</li>
                    <li>å¯¹è§’çº¿ä¸º 1.0ï¼ˆè‡ªå·±ä¸è‡ªå·±å®Œå…¨ç›¸åŒï¼‰</li>
                </ul>
            </div>
        </div>

        <!-- Section 6: è®¡ç®—è¿‡ç¨‹æ¼”ç¤º -->
        <h2><span class="step-number">6</span>è¯¦ç»†è®¡ç®—è¿‡ç¨‹ï¼ˆå‰5ä¸ªç»´åº¦ï¼‰</h2>
        <div class="section">
            <div class="explanation">
                ä»¥ "å¦‚ä½•å­¦ä¹  Java ç¼–ç¨‹" vs "Java å…¥é—¨æ•™ç¨‹" ä¸ºä¾‹ï¼Œå±•ç¤ºå‰ 5 ä¸ªç»´åº¦çš„è®¡ç®—ï¼š
            </div>

            <table>
                <thead>
                    <tr>
                        <th>ç»´åº¦ i</th>
                        <th>vec1[i]<br>(å¥å­1)</th>
                        <th>vec2[i]<br>(å¥å­2)</th>
                        <th>vec1[i] Ã— vec2[i]<br>(ç‚¹ç§¯åˆ†é‡)</th>
                        <th>vec1[i]Â²<br>(æ¨¡é•¿åˆ†é‡)</th>
                        <th>vec2[i]Â²<br>(æ¨¡é•¿åˆ†é‡)</th>
                    </tr>
                </thead>
                <tbody id="calculation-table">
                </tbody>
            </table>

            <div class="formula">
                <strong>å®Œæ•´è®¡ç®—ï¼ˆ768ç»´ï¼‰ï¼š</strong><br>
                <div id="full-calculation"></div>
            </div>
        </div>

        <!-- Section 7: Javaä»£ç å®ç° -->
        <h2><span class="step-number">7</span>Java ä»£ç å®ç°</h2>
        <div class="section">
            <div class="code-block">
<pre style="margin: 0; color: #f8f8f2;">
<span style="color: #66d9ef;">public static double</span> <span style="color: #a6e22e;">cosineSimilarity</span>(<span style="color: #66d9ef;">float</span>[] vec1, <span style="color: #66d9ef;">float</span>[] vec2) {
    <span style="color: #75715e;">// åˆå§‹åŒ–ä¸‰ä¸ªç´¯åŠ å™¨</span>
    <span style="color: #66d9ef;">double</span> dotProduct = <span style="color: #ae81ff;">0.0</span>;  <span style="color: #75715e;">// ç‚¹ç§¯ï¼šAÂ·B</span>
    <span style="color: #66d9ef;">double</span> norm1 = <span style="color: #ae81ff;">0.0</span>;        <span style="color: #75715e;">// ||A||Â²</span>
    <span style="color: #66d9ef;">double</span> norm2 = <span style="color: #ae81ff;">0.0</span>;        <span style="color: #75715e;">// ||B||Â²</span>

    <span style="color: #75715e;">// éå†æ‰€æœ‰ç»´åº¦ï¼ˆ768ç»´ï¼‰</span>
    <span style="color: #f92672;">for</span> (<span style="color: #66d9ef;">int</span> i = <span style="color: #ae81ff;">0</span>; i &lt; vec1.length; i++) {
        dotProduct += vec1[i] * vec2[i];    <span style="color: #75715e;">// ç´¯åŠ ç‚¹ç§¯</span>
        norm1 += vec1[i] * vec1[i];         <span style="color: #75715e;">// ç´¯åŠ Açš„å¹³æ–¹å’Œ</span>
        norm2 += vec2[i] * vec2[i];         <span style="color: #75715e;">// ç´¯åŠ Bçš„å¹³æ–¹å’Œ</span>
    }

    <span style="color: #75715e;">// è¿”å›ä½™å¼¦ç›¸ä¼¼åº¦</span>
    <span style="color: #f92672;">return</span> dotProduct / (Math.<span style="color: #a6e22e;">sqrt</span>(norm1) * Math.<span style="color: #a6e22e;">sqrt</span>(norm2));
}
</pre>
            </div>
        </div>

        <!-- Section 8: å‘é‡ç›¸ä¼¼åº¦ä¸å¤¹è§’å¯¹ç…§è¡¨ -->
        <h2><span class="step-number">8</span>ç›¸ä¼¼åº¦ä¸å¤¹è§’å¯¹ç…§å›¾</h2>
        <div class="section">
            <div class="graph-container" id="cosine-curve"></div>
            <div class="explanation">
                <strong>å¯¹ç…§è¡¨ï¼š</strong>
                <table style="width: 80%; margin: 20px auto;">
                    <tr>
                        <th>å¤¹è§’ Î¸</th>
                        <th>cos(Î¸)</th>
                        <th>ç›¸ä¼¼åº¦åˆ¤æ–­</th>
                        <th>ç¤ºä¾‹</th>
                    </tr>
                    <tr>
                        <td>0Â°</td>
                        <td>1.000</td>
                        <td>å®Œå…¨ç›¸åŒ</td>
                        <td>ç›¸åŒå¥å­</td>
                    </tr>
                    <tr>
                        <td>15Â°</td>
                        <td>0.966</td>
                        <td>éå¸¸ç›¸ä¼¼</td>
                        <td>åŒä¹‰å¥</td>
                    </tr>
                    <tr>
                        <td>30Â°</td>
                        <td>0.866</td>
                        <td>é«˜åº¦ç›¸ä¼¼</td>
                        <td>"Javaç¼–ç¨‹" vs "Javaæ•™ç¨‹"</td>
                    </tr>
                    <tr>
                        <td>45Â°</td>
                        <td>0.707</td>
                        <td>ä¸­ç­‰ç›¸ä¼¼</td>
                        <td>ç›¸å…³ä¸»é¢˜</td>
                    </tr>
                    <tr>
                        <td>60Â°</td>
                        <td>0.500</td>
                        <td>éƒ¨åˆ†ç›¸å…³</td>
                        <td>æœ‰ä¸€å®šå…³è”</td>
                    </tr>
                    <tr>
                        <td>85Â°</td>
                        <td>0.087</td>
                        <td>å‡ ä¹æ— å…³</td>
                        <td>"Java" vs "å¤©æ°”"</td>
                    </tr>
                    <tr>
                        <td>90Â°</td>
                        <td>0.000</td>
                        <td>å®Œå…¨æ— å…³ï¼ˆæ­£äº¤ï¼‰</td>
                        <td>ä¸åŒä¸»é¢˜</td>
                    </tr>
                </table>
            </div>
        </div>

        <!-- Section 9: å®é™…åº”ç”¨æµç¨‹ -->
        <h2><span class="step-number">9</span>Elasticsearch ä¸­çš„åº”ç”¨æµç¨‹</h2>
        <div class="section">
            <div class="graph-container" id="workflow"></div>
        </div>

    </div>

    <script>
        // 1. 2D å‘é‡å¯è§†åŒ–
        function plot2D() {
            // æ¨¡æ‹Ÿå‘é‡ï¼ˆ2Dç®€åŒ–ï¼‰
            const vectors = {
                'å¦‚ä½•å­¦ä¹  Java ç¼–ç¨‹': [0.8, 0.6],
                'Java å…¥é—¨æ•™ç¨‹': [0.85, 0.53],
                'ä»Šå¤©å¤©æ°”çœŸå¥½': [0.1, 0.99]
            };

            const colors = ['#2ecc71', '#3498db', '#e74c3c'];
            const traces = [];
            let index = 0;

            for (const [name, vec] of Object.entries(vectors)) {
                // å‘é‡ç®­å¤´
                traces.push({
                    x: [0, vec[0]],
                    y: [0, vec[1]],
                    mode: 'lines+markers',
                    name: name,
                    line: { color: colors[index], width: 3 },
                    marker: { size: 10 }
                });

                // å‘é‡æ ‡ç­¾
                traces.push({
                    x: [vec[0] * 1.1],
                    y: [vec[1] * 1.1],
                    mode: 'text',
                    text: [name],
                    textposition: 'top center',
                    showlegend: false,
                    textfont: { size: 12, color: colors[index] }
                });

                index++;
            }

            // æ·»åŠ å¤¹è§’æ ‡æ³¨
            const angle1 = Math.atan2(vectors['Java å…¥é—¨æ•™ç¨‹'][1], vectors['Java å…¥é—¨æ•™ç¨‹'][0]);
            const angle2 = Math.atan2(vectors['å¦‚ä½•å­¦ä¹  Java ç¼–ç¨‹'][1], vectors['å¦‚ä½•å­¦ä¹  Java ç¼–ç¨‹'][0]);
            const angleDiff = Math.abs(angle1 - angle2) * 180 / Math.PI;

            const layout = {
                title: '2D å‘é‡ç©ºé—´ä¸­çš„ä½™å¼¦ç›¸ä¼¼åº¦',
                xaxis: { title: 'X è½´', range: [-0.2, 1.2], zeroline: true },
                yaxis: { title: 'Y è½´', range: [-0.2, 1.2], zeroline: true },
                showlegend: true,
                annotations: [
                    {
                        x: 0.3,
                        y: 0.5,
                        text: `Î¸â‚ â‰ˆ ${angleDiff.toFixed(1)}Â°<br>ç›¸ä¼¼åº¦é«˜`,
                        showarrow: true,
                        arrowhead: 2,
                        ax: -40,
                        ay: -40
                    }
                ],
                height: 500
            };

            Plotly.newPlot('plot2d', traces, layout);
        }

        // 2. 3D å‘é‡å¯è§†åŒ–
        function plot3D() {
            const vectors = {
                'å¦‚ä½•å­¦ä¹  Java ç¼–ç¨‹': [0.8, 0.6, 0.3],
                'Java å…¥é—¨æ•™ç¨‹': [0.85, 0.53, 0.35],
                'ä»Šå¤©å¤©æ°”çœŸå¥½': [0.1, 0.99, -0.2]
            };

            const colors = ['#2ecc71', '#3498db', '#e74c3c'];
            const traces = [];
            let index = 0;

            for (const [name, vec] of Object.entries(vectors)) {
                // ä»åŸç‚¹åˆ°å‘é‡ç«¯ç‚¹çš„çº¿
                traces.push({
                    x: [0, vec[0]],
                    y: [0, vec[1]],
                    z: [0, vec[2]],
                    mode: 'lines+markers',
                    type: 'scatter3d',
                    name: name,
                    line: { color: colors[index], width: 6 },
                    marker: { size: 8 }
                });

                index++;
            }

            const layout = {
                title: '3D å‘é‡ç©ºé—´å¯è§†åŒ–',
                scene: {
                    xaxis: { title: 'X' },
                    yaxis: { title: 'Y' },
                    zaxis: { title: 'Z' }
                },
                height: 600
            };

            Plotly.newPlot('plot3d', traces, layout);
        }

        // 3. é«˜ç»´é™ç»´å¯è§†åŒ–
        function plotHighDim() {
            // æ¨¡æ‹Ÿæ›´å¤šå¥å­çš„å‘é‡ï¼ˆé™ç»´åˆ°2Dï¼‰
            const sentences = [
                { name: 'å¦‚ä½•å­¦ä¹  Java ç¼–ç¨‹', x: 2.3, y: 1.8, category: 'Java' },
                { name: 'Java å…¥é—¨æ•™ç¨‹', x: 2.5, y: 1.6, category: 'Java' },
                { name: 'Java åŸºç¡€çŸ¥è¯†', x: 2.1, y: 2.0, category: 'Java' },
                { name: 'Python ç¼–ç¨‹å…¥é—¨', x: -1.5, y: 2.2, category: 'Python' },
                { name: 'Python æ•™ç¨‹', x: -1.3, y: 2.4, category: 'Python' },
                { name: 'ä»Šå¤©å¤©æ°”çœŸå¥½', x: 0.2, y: -2.8, category: 'å¤©æ°”' },
                { name: 'æ˜å¤©ä¸‹é›¨å—', x: 0.5, y: -2.5, category: 'å¤©æ°”' },
                { name: 'Elasticsearch æœç´¢', x: 3.2, y: -1.2, category: 'æŠ€æœ¯' }
            ];

            const categories = ['Java', 'Python', 'å¤©æ°”', 'æŠ€æœ¯'];
            const categoryColors = {
                'Java': '#2ecc71',
                'Python': '#3498db',
                'å¤©æ°”': '#e74c3c',
                'æŠ€æœ¯': '#f39c12'
            };

            const traces = categories.map(cat => {
                const filtered = sentences.filter(s => s.category === cat);
                return {
                    x: filtered.map(s => s.x),
                    y: filtered.map(s => s.y),
                    mode: 'markers+text',
                    type: 'scatter',
                    name: cat,
                    text: filtered.map(s => s.name),
                    textposition: 'top center',
                    marker: {
                        size: 15,
                        color: categoryColors[cat],
                        line: { width: 2, color: 'white' }
                    }
                };
            });

            const layout = {
                title: '768ç»´å‘é‡é™ç»´åˆ°2Dï¼ˆPCA/t-SNEæ¨¡æ‹Ÿï¼‰',
                xaxis: { title: 'ä¸»æˆåˆ† 1', zeroline: true },
                yaxis: { title: 'ä¸»æˆåˆ† 2', zeroline: true },
                height: 600,
                hovermode: 'closest'
            };

            Plotly.newPlot('plotHighDim', traces, layout);
        }

        // 4. ç›¸ä¼¼åº¦çŸ©é˜µçƒ­åŠ›å›¾
        function plotHeatmap() {
            const sentences = [
                'å¦‚ä½•å­¦ä¹  Java ç¼–ç¨‹',
                'Java å…¥é—¨æ•™ç¨‹',
                'Python ç¼–ç¨‹',
                'ä»Šå¤©å¤©æ°”çœŸå¥½',
                'Elasticsearch æœç´¢'
            ];

            // æ¨¡æ‹Ÿç›¸ä¼¼åº¦çŸ©é˜µ
            const similarityMatrix = [
                [1.000, 0.872, 0.543, 0.123, 0.634],
                [0.872, 1.000, 0.512, 0.098, 0.598],
                [0.543, 0.512, 1.000, 0.087, 0.456],
                [0.123, 0.098, 0.087, 1.000, 0.134],
                [0.634, 0.598, 0.456, 0.134, 1.000]
            ];

            const data = [{
                z: similarityMatrix,
                x: sentences,
                y: sentences,
                type: 'heatmap',
                colorscale: 'RdYlBu',
                reversescale: true,
                text: similarityMatrix.map(row => row.map(val => val.toFixed(3))),
                texttemplate: '%{text}',
                textfont: { size: 12 },
                colorbar: {
                    title: 'ç›¸ä¼¼åº¦',
                    tickvals: [0, 0.25, 0.5, 0.75, 1.0]
                }
            }];

            const layout = {
                title: 'å¥å­ç›¸ä¼¼åº¦çŸ©é˜µï¼ˆçƒ­åŠ›å›¾ï¼‰',
                xaxis: { tickangle: -45 },
                yaxis: { tickangle: 0 },
                height: 600
            };

            Plotly.newPlot('heatmap', data, layout);
        }

        // 5. è®¡ç®—è¿‡ç¨‹è¡¨æ ¼
        function fillCalculationTable() {
            // æ¨¡æ‹Ÿå‰5ä¸ªç»´åº¦çš„å‘é‡å€¼
            const vec1 = [0.123, -0.456, 0.789, 0.234, -0.123];
            const vec2 = [0.145, -0.423, 0.812, 0.267, -0.098];

            const tbody = document.getElementById('calculation-table');
            let dotProductSum = 0;
            let norm1Sum = 0;
            let norm2Sum = 0;

            for (let i = 0; i < 5; i++) {
                const dotProd = vec1[i] * vec2[i];
                const sq1 = vec1[i] * vec1[i];
                const sq2 = vec2[i] * vec2[i];

                dotProductSum += dotProd;
                norm1Sum += sq1;
                norm2Sum += sq2;

                const row = `
                    <tr>
                        <td>${i}</td>
                        <td>${vec1[i].toFixed(6)}</td>
                        <td>${vec2[i].toFixed(6)}</td>
                        <td>${dotProd.toFixed(6)}</td>
                        <td>${sq1.toFixed(6)}</td>
                        <td>${sq2.toFixed(6)}</td>
                    </tr>
                `;
                tbody.innerHTML += row;
            }

            // æ·»åŠ çœç•¥è¡Œ
            tbody.innerHTML += `
                <tr style="background: #fffacd;">
                    <td colspan="6">... (çœç•¥åç»­ 763 ä¸ªç»´åº¦çš„è®¡ç®—) ...</td>
                </tr>
            `;

            // æ¨¡æ‹Ÿå®Œæ•´768ç»´çš„ç»“æœ
            const fullDotProduct = 245.671234;
            const fullNorm1 = 336.234567;
            const fullNorm2 = 344.456789;
            const similarity = fullDotProduct / (Math.sqrt(fullNorm1) * Math.sqrt(fullNorm2));

            document.getElementById('full-calculation').innerHTML = `
                â€¢ ç‚¹ç§¯æ€»å’Œ (AÂ·B) = ${fullDotProduct.toFixed(6)}<br>
                â€¢ ||A||Â² = ${fullNorm1.toFixed(6)} â†’ ||A|| = ${Math.sqrt(fullNorm1).toFixed(6)}<br>
                â€¢ ||B||Â² = ${fullNorm2.toFixed(6)} â†’ ||B|| = ${Math.sqrt(fullNorm2).toFixed(6)}<br>
                â€¢ <span class="highlight">ä½™å¼¦ç›¸ä¼¼åº¦ = ${fullDotProduct.toFixed(6)} / (${Math.sqrt(fullNorm1).toFixed(6)} Ã— ${Math.sqrt(fullNorm2).toFixed(6)}) = ${similarity.toFixed(6)}</span>
            `;
        }

        // 6. ä½™å¼¦å‡½æ•°æ›²çº¿
        function plotCosineCurve() {
            const angles = [];
            const cosines = [];

            for (let theta = 0; theta <= 180; theta += 1) {
                angles.push(theta);
                cosines.push(Math.cos(theta * Math.PI / 180));
            }

            // æ ‡æ³¨é‡è¦ç‚¹
            const importantPoints = [
                { angle: 0, value: 1.0, label: '0Â°: å®Œå…¨ç›¸åŒ' },
                { angle: 15, value: Math.cos(15 * Math.PI / 180), label: '15Â°: éå¸¸ç›¸ä¼¼ (0.966)' },
                { angle: 45, value: Math.cos(45 * Math.PI / 180), label: '45Â°: ä¸­ç­‰ç›¸ä¼¼ (0.707)' },
                { angle: 85, value: Math.cos(85 * Math.PI / 180), label: '85Â°: å‡ ä¹æ— å…³ (0.087)' },
                { angle: 90, value: 0, label: '90Â°: æ­£äº¤ (0.0)' }
            ];

            const trace = {
                x: angles,
                y: cosines,
                mode: 'lines',
                name: 'cos(Î¸)',
                line: { color: '#3498db', width: 3 }
            };

            const pointTrace = {
                x: importantPoints.map(p => p.angle),
                y: importantPoints.map(p => p.value),
                mode: 'markers+text',
                name: 'å…³é”®ç‚¹',
                text: importantPoints.map(p => p.label),
                textposition: 'top center',
                marker: { size: 10, color: '#e74c3c' }
            };

            const layout = {
                title: 'ä½™å¼¦ç›¸ä¼¼åº¦ä¸å¤¹è§’çš„å…³ç³»',
                xaxis: { title: 'å¤¹è§’ Î¸ (åº¦)', range: [0, 180] },
                yaxis: { title: 'cos(Î¸) = ç›¸ä¼¼åº¦', range: [-0.2, 1.1] },
                height: 500,
                shapes: [
                    // æ·»åŠ å‚è€ƒçº¿
                    { type: 'line', x0: 0, x1: 180, y0: 0.5, y1: 0.5,
                      line: { dash: 'dash', color: 'gray' } }
                ]
            };

            Plotly.newPlot('cosine-curve', [trace, pointTrace], layout);
        }

        // 7. åº”ç”¨æµç¨‹å›¾
        function plotWorkflow() {
            const data = [{
                type: "sankey",
                node: {
                    pad: 15,
                    thickness: 20,
                    line: { color: "black", width: 0.5 },
                    label: [
                        "åŸå§‹æ–‡æœ¬",
                        "GTE å‘é‡æœåŠ¡",
                        "768ç»´å‘é‡",
                        "Elasticsearch",
                        "æŸ¥è¯¢æ–‡æœ¬",
                        "æŸ¥è¯¢å‘é‡",
                        "kNN æœç´¢",
                        "è®¡ç®—ç›¸ä¼¼åº¦",
                        "è¿”å›ç»“æœ"
                    ],
                    color: [
                        "#3498db", "#2ecc71", "#f39c12", "#9b59b6",
                        "#3498db", "#f39c12", "#e74c3c", "#1abc9c", "#34495e"
                    ]
                },
                link: {
                    source: [0, 1, 2, 4, 5, 6, 7, 3],
                    target: [1, 2, 3, 1, 6, 7, 8, 7],
                    value: [1, 1, 1, 1, 1, 1, 1, 1]
                }
            }];

            const layout = {
                title: "Elasticsearch è¯­ä¹‰æœç´¢æµç¨‹",
                height: 400,
                font: { size: 12 }
            };

            Plotly.newPlot('workflow', data, layout);
        }

        // åˆå§‹åŒ–æ‰€æœ‰å›¾è¡¨
        window.onload = function() {
            plot2D();
            plot3D();
            plotHighDim();
            plotHeatmap();
            fillCalculationTable();
            plotCosineCurve();
            plotWorkflow();
        };
    </script>
</body>
</html>
